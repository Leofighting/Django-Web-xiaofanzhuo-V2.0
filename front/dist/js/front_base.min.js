function FrontBase(){}function Auth(){var t=this;t.maskWrapper=$(".mask-wrapper"),t.scrollWrapper=$(".scroll-wrapper"),t.signinGroup=$(".signin-group"),t.signupGroup=$(".signup-group"),t.smsCaptcha=$(".sms-captcha-btn")}FrontBase.prototype.listenAuthBoxHover=function(){var t=$(".auth-box"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},FrontBase.prototype.run=function(){this.listenAuthBoxHover()},$(function(){(new FrontBase).run()}),Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenShowHideEvent=function(){var t=this,n=$(".signin-btn"),e=$(".signup-btn"),s=$(".close-btn");n.click(function(){t.showEvent(),t.scrollWrapper.css({left:0})}),e.click(function(){t.showEvent(),t.scrollWrapper.css({left:-400})}),s.click(function(){t.hideEvent()})},Auth.prototype.listenSwitchEvent=function(){var n=this;$(".switch").click(function(){var t=n.scrollWrapper.css("left");(t=parseInt(t))<0?n.scrollWrapper.animate({left:"0"},500):n.scrollWrapper.animate({left:"-400px"},500)})},Auth.prototype.listenSigninEvent=function(){var s=this,a=s.signinGroup.find("input[name='telephone']"),i=s.signinGroup.find("input[name='password']"),o=s.signinGroup.find("input[name='remember']");s.signinGroup.find(".submit-btn").click(function(){var t=a.val(),n=i.val(),e=o.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:t,password:n,remember:e?1:0},success:function(t){s.hideEvent(),window.location.reload()}})})},Auth.prototype.listenImgCaptchaEvent=function(){var t=$(".img_captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.smsSuccessEvent=function(){var t=this;messageBox.showSuccess("短信验证码发送成功~"),t.smsCaptcha.addClass("disabled");var n=60;t.smsCaptcha.unbind("click");var e=setInterval(function(){t.smsCaptcha.text(n+"s"),--n<=0&&(clearInterval(e),t.smsCaptcha.removeClass("disabled"),t.smsCaptcha.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenSmsCaptchaEvent=function(){var n=this,e=n.signupGroup.find("input[name='telephone']");n.smsCaptcha.click(function(){var t=e.val();t||messageBox.showInfo("请输入手机号码~"),xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200===t.code&&n.smsSuccessEvent()}})})},Auth.prototype.listenSignupEvent=function(){var m=this;m.signupGroup.find(".submit-btn").click(function(t){t.preventDefault();var n=m.signupGroup.find("input[name='telephone']"),e=m.signupGroup.find("input[name='username']"),s=m.signupGroup.find("input[name='img_captcha']"),a=m.signupGroup.find("input[name='password1']"),i=m.signupGroup.find("input[name='password2']"),o=m.signupGroup.find("input[name='sms_captcha']"),p=n.val(),r=e.val(),c=s.val(),u=a.val(),l=i.val(),h=o.val();xfzajax.post({url:"/account/register/",data:{telephone:p,username:r,img_captcha:c,password1:u,password2:l,sms_captcha:h},success:function(t){window.location.reload()}})})},Auth.prototype.run=function(){var t=this;t.listenShowHideEvent(),t.listenSwitchEvent(),t.listenSigninEvent(),t.listenImgCaptchaEvent(),t.listenSmsCaptchaEvent(),t.listenSignupEvent()},$(function(){(new Auth).run()}),$(function(){template&&(template.defaults.imports.timeSince=function(t){var n=new Date(t),e=n.getTime(),s=((new Date).getTime()-e)/1e3;return s<60?"刚刚":60<=s&&s<3600?(minutes=parseInt(s/60),minutes+"分钟前"):3600<=s&&s<86400?(hours=parseInt(s/60/60),hours+"小时前"):86400<=s&&s<2592e3?(days=parseInt(s/60/60/24),days+"天前"):n.getFullYear()+"/"+(n.getMonth()+1)+"/"+n.getDay()+" "+n.getHours()+":"+n.getMinutes()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZyb250X2Jhc2UuanMiXSwibmFtZXMiOlsiRnJvbnRCYXNlIiwiQXV0aCIsInNlbGYiLCJ0aGlzIiwibWFza1dyYXBwZXIiLCIkIiwic2Nyb2xsV3JhcHBlciIsInNpZ25pbkdyb3VwIiwic2lnbnVwR3JvdXAiLCJzbXNDYXB0Y2hhIiwicHJvdG90eXBlIiwibGlzdGVuQXV0aEJveEhvdmVyIiwiYXV0aEJveCIsInVzZXJNb3JlQm94IiwiaG92ZXIiLCJzaG93IiwiaGlkZSIsInJ1biIsInNob3dFdmVudCIsImhpZGVFdmVudCIsImxpc3RlblNob3dIaWRlRXZlbnQiLCJzaWduaW5CdG4iLCJzaWdudXBCdG4iLCJjbG9zZUJ0biIsImNsaWNrIiwiY3NzIiwibGVmdCIsImxpc3RlblN3aXRjaEV2ZW50IiwiY3VycmVudExlZnQiLCJwYXJzZUludCIsImFuaW1hdGUiLCJsaXN0ZW5TaWduaW5FdmVudCIsInRlbGVwaG9uZUlucHV0IiwiZmluZCIsInBhc3N3b3JkSW5wdXQiLCJyZW1lbWJlcklucHV0IiwidGVsZXBob25lIiwidmFsIiwicGFzc3dvcmQiLCJyZW1lbWJlciIsInByb3AiLCJ4ZnphamF4IiwicG9zdCIsInVybCIsImRhdGEiLCJzdWNjZXNzIiwicmVzdWx0Iiwid2luZG93IiwibG9jYXRpb24iLCJyZWxvYWQiLCJsaXN0ZW5JbWdDYXB0Y2hhRXZlbnQiLCJpbWdDYXB0Y2hhIiwiYXR0ciIsIk1hdGgiLCJyYW5kb20iLCJzbXNTdWNjZXNzRXZlbnQiLCJtZXNzYWdlQm94Iiwic2hvd1N1Y2Nlc3MiLCJhZGRDbGFzcyIsImNvdW50IiwidW5iaW5kIiwidGltZXIiLCJzZXRJbnRlcnZhbCIsInRleHQiLCJjbGVhckludGVydmFsIiwicmVtb3ZlQ2xhc3MiLCJsaXN0ZW5TbXNDYXB0Y2hhRXZlbnQiLCJzaG93SW5mbyIsImdldCIsImxpc3RlblNpZ251cEV2ZW50IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInVzZXJuYW1lSW5wdXQiLCJpbWdDYXB0Y2hhSW5wdXQiLCJwYXNzd29yZDFJbnB1dCIsInBhc3N3b3JkMklucHV0Iiwic21zQ2FwdGNoYUlucHV0IiwidXNlcm5hbWUiLCJpbWdfY2FwdGNoYSIsInBhc3N3b3JkMSIsInBhc3N3b3JkMiIsInNtc19jYXB0Y2hhIiwidGVtcGxhdGUiLCJkZWZhdWx0cyIsImltcG9ydHMiLCJ0aW1lU2luY2UiLCJkYXRlVmFsdWUiLCJkYXRlIiwiRGF0ZSIsImRhdGV0cyIsImdldFRpbWUiLCJ0aW1lc3RhbXAiLCJtaW51dGVzIiwiaG91cnMiLCJkYXlzIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERheSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyJdLCJtYXBwaW5ncyI6IkFBQ0EsU0FBU0EsYUEyQlQsU0FBU0MsT0FDTCxJQUFJQyxFQUFPQyxLQUNYRCxFQUFLRSxZQUFjQyxFQUFFLGlCQUNyQkgsRUFBS0ksY0FBZ0JELEVBQUUsbUJBQ3ZCSCxFQUFLSyxZQUFjRixFQUFFLGlCQUNyQkgsRUFBS00sWUFBY0gsRUFBRSxpQkFDckJILEVBQUtPLFdBQWFKLEVBQUUsb0JBN0J4QkwsVUFBVVUsVUFBVUMsbUJBQXFCLFdBQ3JDLElBQUlDLEVBQVVQLEVBQUUsYUFDWlEsRUFBY1IsRUFBRSxrQkFDcEJPLEVBQVFFLE1BQU0sV0FDVkQsRUFBWUUsUUFDYixXQUNDRixFQUFZRyxVQUlwQmhCLFVBQVVVLFVBQVVPLElBQU0sV0FDWGQsS0FDTlEsc0JBSVROLEVBQUUsWUFDa0IsSUFBSUwsV0FDVmlCLFFBY2RoQixLQUFLUyxVQUFVUSxVQUFZLFdBQ1pmLEtBQ05DLFlBQVlXLFFBR3JCZCxLQUFLUyxVQUFVUyxVQUFZLFdBQ1poQixLQUNOQyxZQUFZWSxRQUVyQmYsS0FBS1MsVUFBVVUsb0JBQXNCLFdBQ2pDLElBQUlsQixFQUFPQyxLQUNQa0IsRUFBWWhCLEVBQUUsZUFDZGlCLEVBQVlqQixFQUFFLGVBQ2RrQixFQUFXbEIsRUFBRSxjQUVqQmdCLEVBQVVHLE1BQU0sV0FDWnRCLEVBQUtnQixZQUNMaEIs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WUwsRUFBZXRDLE1BQzNCNEMsRUFBY0wsRUFBZ0J2QyxNQUVsQ0ksUUFBUUMsS0FBSyxDQUNUQyxJQUFPLHFCQUNQQyxLQUFRLENBQ0pSLFVBQWFBLEVBQ2J5QyxTQUFZQSxFQUNaQyxZQUFlQSxFQUNmQyxVQUFhQSxFQUNiQyxVQUFhQSxFQUNiQyxZQUFlQSxHQUVuQnBDLFFBQVcsU0FBVUMsR0FDakJDLE9BQU9DLFNBQVNDLGVBTWhDaEQsS0FBS1MsVUFBVU8sSUFBTSxXQUNqQixJQUFJZixFQUFPQyxLQUNYRCxFQUFLa0Isc0JBQ0xsQixFQUFLeUIsb0JBQ0x6QixFQUFLNkIsb0JBQ0w3QixFQUFLZ0Qsd0JBQ0xoRCxFQUFLZ0Usd0JBQ0xoRSxFQUFLbUUscUJBR1RoRSxFQUFFLFlBQ2EsSUFBSUosTUFDVmdCLFFBR1RaLEVBQUUsV0FDTTZFLFdBQ0FBLFNBQVNDLFNBQVNDLFFBQVFDLFVBQVksU0FBVUMsR0FDNUMsSUFBSUMsRUFBTyxJQUFJQyxLQUFLRixHQUNoQkcsRUFBU0YsRUFBS0csVUFFZEMsSUFEUSxJQUFLSCxNQUFRRSxVQUNBRCxHQUFVLElBQ25DLE9BQUlFLEVBQVksR0FDTCxLQUNhLElBQWJBLEdBQW1CQSxFQUFZLE1BQ3RDQyxRQUFVL0QsU0FBUzhELEVBQVksSUFDeEJDLFFBQVUsT0FDRyxNQUFiRCxHQUF3QkEsRUFBWSxPQUMzQ0UsTUFBUWhFLFNBQVM4RCxFQUFZLEdBQUssSUFDM0JFLE1BQVEsT0FDSyxPQUFiRixHQUE2QkEsRUFBWSxRQUNoREcsS0FBT2pFLFNBQVM4RCxFQUFZLEdBQUssR0FBSyxJQUMvQkcsS0FBTyxNQUVIUCxFQUFLUSxjQUtGLEtBSkZSLEVBQUtTLFdBQWEsR0FJRixJQUhsQlQsRUFBS1UsU0FHeUIsSUFGN0JWLEVBQUtXLFdBRXFDLElBRHhDWCxFQUFLWSIsImZpbGUiOiJmcm9udF9iYXNlLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIOeUqOS6juWkhOeQhuWvvOiIquadoVxyXG5mdW5jdGlvbiBGcm9udEJhc2UoKSB7XHJcblxyXG59XHJcblxyXG5Gcm9udEJhc2UucHJvdG90eXBlLmxpc3RlbkF1dGhCb3hIb3ZlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBhdXRoQm94ID0gJChcIi5hdXRoLWJveFwiKTtcclxuICAgIHZhciB1c2VyTW9yZUJveCA9ICQoXCIudXNlci1tb3JlLWJveFwiKTtcclxuICAgIGF1dGhCb3guaG92ZXIoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHVzZXJNb3JlQm94LnNob3coKTtcclxuICAgIH0sIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB1c2VyTW9yZUJveC5oaWRlKCk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbkZyb250QmFzZS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5saXN0ZW5BdXRoQm94SG92ZXIoKTtcclxuXHJcbn07XHJcblxyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBmcm9udEJhc2UgPSBuZXcgRnJvbnRCYXNlKCk7XHJcbiAgICBmcm9udEJhc2UucnVuKCk7XHJcbn0pO1xyXG5cclxuXHJcbi8vIOeUqOS6juWkhOeQhueZu+W9leazqOWGjFxyXG5mdW5jdGlvbiBBdXRoKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5tYXNrV3JhcHBlciA9ICQoXCIubWFzay13cmFwcGVyXCIpO1xyXG4gICAgc2VsZi5zY3JvbGxXcmFwcGVyID0gJChcIi5zY3JvbGwtd3JhcHBlclwiKTtcclxuICAgIHNlbGYuc2lnbmluR3JvdXAgPSAkKFwiLnNpZ25pbi1ncm91cFwiKTtcclxuICAgIHNlbGYuc2lnbnVwR3JvdXAgPSAkKFwiLnNpZ251cC1ncm91cFwiKTtcclxuICAgIHNlbGYuc21zQ2FwdGNoYSA9ICQoXCIuc21zLWNhcHRjaGEtYnRuXCIpO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUuc2hvd0V2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgc2VsZi5tYXNrV3JhcHBlci5zaG93KCk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5oaWRlRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLm1hc2tXcmFwcGVyLmhpZGUoKTtcclxufTtcclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU2hvd0hpZGVFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBzaWduaW5CdG4gPSAkKFwiLnNpZ25pbi1idG5cIik7XHJcbiAgICB2YXIgc2lnbnVwQnRuID0gJChcIi5zaWdudXAtYnRuXCIpO1xyXG4gICAgdmFyIGNsb3NlQnRuID0gJChcIi5jbG9zZS1idG5cIik7XHJcblxyXG4gICAgc2lnbmluQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBzZWxmLnNob3dFdmVudCgpO1xyXG4gICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5jc3Moe1wibGVmdFwiOiAwfSk7XHJcbiAgICB9KTtcclxuICAgIHNpZ251cEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zaG93RXZlbnQoKTtcclxuICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuY3NzKHtcImxlZnRcIjogLTQwMH0pO1xyXG4gICAgfSk7XHJcbiAgICBjbG9zZUJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5oaWRlRXZlbnQoKTtcclxuICAgIH0pO1xyXG5cclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblN3aXRjaEV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHN3aXRjaGVyID0gJChcIi5zd2l0Y2hcIik7XHJcbiAgICBzd2l0Y2hlci5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGN1cnJlbnRMZWZ0ID0gc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyhcImxlZnRcIik7XHJcbiAgICAgICAgY3VycmVudExlZnQgPSBwYXJzZUludChjdXJyZW50TGVmdCk7XHJcbiAgICAgICAgaWYgKGN1cnJlbnRMZWZ0IDwgMCkge1xyXG4gICAgICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7XCJsZWZ0XCI6IFwiMFwifSwgNTAwKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZWxmLnNjcm9sbFdyYXBwZXIuYW5pbWF0ZSh7XCJsZWZ0XCI6IFwiLTQwMHB4XCJ9LCA1MDApO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU2lnbmluRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAvLyB2YXIgc2lnbmluR3JvdXAgPSAkKFwiLnNpZ25pbi1ncm91cFwiKTtcclxuICAgIHZhciB0ZWxlcGhvbmVJbnB1dCA9IHNlbGYuc2lnbmluR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xyXG4gICAgdmFyIHBhc3N3b3JkSW5wdXQgPSBzZWxmLnNpZ25pbkdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZCddXCIpO1xyXG4gICAgdmFyIHJlbWVtYmVySW5wdXQgPSBzZWxmLnNpZ25pbkdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdyZW1lbWJlciddXCIpO1xyXG5cclxuICAgIHZhciBzdWJtaXRCdG4gPSBzZWxmLnNpZ25pbkdyb3VwLmZpbmQoXCIuc3VibWl0LWJ0blwiKTtcclxuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZCA9IHBhc3N3b3JkSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHJlbWVtYmVyID0gcmVtZW1iZXJJbnB1dC5wcm9wKFwiY2hlY2tlZFwiKTtcclxuXHJcbiAgICAgICAgeGZ6YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgXCJ1cmxcIjogXCIvYWNjb3VudC9sb2dpbi9cIixcclxuICAgICAgICAgICAgXCJkYXRhXCI6IHtcclxuICAgICAgICAgICAgICAgIFwidGVsZXBob25lXCI6IHRlbGVwaG9uZSxcclxuICAgICAgICAgICAgICAgIFwicGFzc3dvcmRcIjogcGFzc3dvcmQsXHJcbiAgICAgICAgICAgICAgICBcInJlbWVtYmVyXCI6IHJlbWVtYmVyID8gMSA6IDBcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgXCJzdWNjZXNzXCI6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYuaGlkZUV2ZW50KCk7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICAvLyBpZiAocmVzdWx0W1wiY29kZVwiXSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgc2VsZi5oaWRlRXZlbnQoKTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbiAgICAgICAgICAgICAgICAvLyB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgIHZhciBtZXNzYWdlT2JqZWN0ID0gcmVzdWx0W1wibWVzc2FnZVwiXTtcclxuICAgICAgICAgICAgICAgIC8vICAgICBpZiAodHlwZW9mIG1lc3NhZ2VPYmplY3QgPT0gXCJzdHJpbmdcIiB8fCBtZXNzYWdlT2JqZWN0LmNvbnN0cnVjdG9yID09PSBTdHJpbmcpIHtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlT2JqZWN0KTtcclxuICAgICAgICAgICAgICAgIC8vICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBmb3IgKHZhciBrZXkgaW4gbWVzc2FnZU9iamVjdCkge1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIG1lc3NhZ2VzID0gbWVzc2FnZU9iamVjdFtrZXldO1xyXG4gICAgICAgICAgICAgICAgLy8gICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBtZXNzYWdlc1swXTtcclxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3cobWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuSW1nQ2FwdGNoYUV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGltZ0NhcHRjaGEgPSAkKFwiLmltZ19jYXB0Y2hhXCIpO1xyXG4gICAgaW1nQ2FwdGNoYS5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaW1nQ2FwdGNoYS5hdHRyKFwic3JjXCIsIFwiL2FjY291bnQvaW1nX2NhcHRjaGEvXCIgKyBcIj9yYW5kb209XCIgKyBNYXRoLnJhbmRvbSgpKVxyXG4gICAgfSk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5zbXNTdWNjZXNzRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBtZXNzYWdlQm94LnNob3dTdWNjZXNzKFwi55+t5L+h6aqM6K+B56CB5Y+R6YCB5oiQ5YqfflwiKTtcclxuICAgIHNlbGYuc21zQ2FwdGNoYS5hZGRDbGFzcyhcImRpc2FibGVkXCIpO1xyXG4gICAgdmFyIGNvdW50ID0gNjA7XHJcbiAgICBzZWxmLnNtc0NhcHRjaGEudW5iaW5kKFwiY2xpY2tcIik7XHJcbiAgICB2YXIgdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnRleHQoY291bnQgKyBcInNcIik7XHJcbiAgICAgICAgY291bnQtLTtcclxuICAgICAgICBpZiAoY291bnQgPD0gMCkge1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKTtcclxuICAgICAgICAgICAgc2VsZi5zbXNDYXB0Y2hhLnJlbW92ZUNsYXNzKFwiZGlzYWJsZWRcIik7XHJcbiAgICAgICAgICAgIHNlbGYuc21zQ2FwdGNoYS50ZXh0KFwi5Y+R6YCB6aqM6K+B56CBXCIpO1xyXG4gICAgICAgICAgICBzZWxmLmxpc3RlblNtc0NhcHRjaGFFdmVudCgpO1xyXG4gICAgICAgIH1cclxuICAgIH0sIDEwMDApO1xyXG59O1xyXG5cclxuQXV0aC5wcm90b3R5cGUubGlzdGVuU21zQ2FwdGNoYUV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2VsZi5zaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XHJcbiAgICBzZWxmLnNtc0NhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciB0ZWxlcGhvbmUgPSB0ZWxlcGhvbmVJbnB1dC52YWwoKTtcclxuICAgICAgICBpZiAoIXRlbGVwaG9uZSkge1xyXG4gICAgICAgICAgICBtZXNzYWdlQm94LnNob3dJbmZvKFwi6K+36L6T5YWl5omL5py65Y+356CBflwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgeGZ6YWpheC5nZXQoe1xyXG4gICAgICAgICAgICBcInVybFwiOiBcIi9hY2NvdW50L3Ntc19jYXB0Y2hhL1wiLFxyXG4gICAgICAgICAgICBcImRhdGFcIjoge1xyXG4gICAgICAgICAgICAgICAgXCJ0ZWxlcGhvbmVcIjogdGVsZXBob25lXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIFwic3VjY2Vzc1wiOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0W1wiY29kZVwiXSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5zbXNTdWNjZXNzRXZlbnQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG5cclxufTtcclxuXHJcbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ251cEV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIHN1Ym1pdEJ0biA9IHNlbGYuc2lnbnVwR3JvdXAuZmluZChcIi5zdWJtaXQtYnRuXCIpO1xyXG4gICAgc3VibWl0QnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2VsZi5zaWdudXBHcm91cC5maW5kKFwiaW5wdXRbbmFtZT0ndGVsZXBob25lJ11cIik7XHJcbiAgICAgICAgdmFyIHVzZXJuYW1lSW5wdXQgPSBzZWxmLnNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd1c2VybmFtZSddXCIpO1xyXG4gICAgICAgIHZhciBpbWdDYXB0Y2hhSW5wdXQgPSBzZWxmLnNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdpbWdfY2FwdGNoYSddXCIpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDFJbnB1dCA9IHNlbGYuc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkMSddXCIpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDJJbnB1dCA9IHNlbGYuc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkMiddXCIpO1xyXG4gICAgICAgIHZhciBzbXNDYXB0Y2hhSW5wdXQgPSBzZWxmLnNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdzbXNfY2FwdGNoYSddXCIpO1xyXG5cclxuICAgICAgICB2YXIgdGVsZXBob25lID0gdGVsZXBob25lSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHVzZXJuYW1lID0gdXNlcm5hbWVJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgaW1nX2NhcHRjaGEgPSBpbWdDYXB0Y2hhSW5wdXQudmFsKCk7XHJcbiAgICAgICAgdmFyIHBhc3N3b3JkMSA9IHBhc3N3b3JkMUlucHV0LnZhbCgpO1xyXG4gICAgICAgIHZhciBwYXNzd29yZDIgPSBwYXNzd29yZDJJbnB1dC52YWwoKTtcclxuICAgICAgICB2YXIgc21zX2NhcHRjaGEgPSBzbXNDYXB0Y2hhSW5wdXQudmFsKCk7XHJcblxyXG4gICAgICAgIHhmemFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgIFwidXJsXCI6IFwiL2FjY291bnQvcmVnaXN0ZXIvXCIsXHJcbiAgICAgICAgICAgIFwiZGF0YVwiOiB7XHJcbiAgICAgICAgICAgICAgICBcInRlbGVwaG9uZVwiOiB0ZWxlcGhvbmUsXHJcbiAgICAgICAgICAgICAgICBcInVzZXJuYW1lXCI6IHVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgXCJpbWdfY2FwdGNoYVwiOiBpbWdfY2FwdGNoYSxcclxuICAgICAgICAgICAgICAgIFwicGFzc3dvcmQxXCI6IHBhc3N3b3JkMSxcclxuICAgICAgICAgICAgICAgIFwicGFzc3dvcmQyXCI6IHBhc3N3b3JkMixcclxuICAgICAgICAgICAgICAgIFwic21zX2NhcHRjaGFcIjogc21zX2NhcHRjaGFcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgXCJzdWNjZXNzXCI6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5BdXRoLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICBzZWxmLmxpc3RlblNob3dIaWRlRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuU3dpdGNoRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuU2lnbmluRXZlbnQoKTtcclxuICAgIHNlbGYubGlzdGVuSW1nQ2FwdGNoYUV2ZW50KCk7XHJcbiAgICBzZWxmLmxpc3RlblNtc0NhcHRjaGFFdmVudCgpO1xyXG4gICAgc2VsZi5saXN0ZW5TaWdudXBFdmVudCgpO1xyXG59O1xyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgYXV0aCA9IG5ldyBBdXRoKCk7XHJcbiAgICBhdXRoLnJ1bigpO1xyXG59KTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKHRlbXBsYXRlKSB7XHJcbiAgICAgICAgdGVtcGxhdGUuZGVmYXVsdHMuaW1wb3J0cy50aW1lU2luY2UgPSBmdW5jdGlvbiAoZGF0ZVZhbHVlKSB7XHJcbiAgICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoZGF0ZVZhbHVlKTtcclxuICAgICAgICAgICAgdmFyIGRhdGV0cyA9IGRhdGUuZ2V0VGltZSgpO1xyXG4gICAgICAgICAgICB2YXIgbm93dHMgPSAobmV3IERhdGUoKSkuZ2V0VGltZSgpO1xyXG4gICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gKG5vd3RzIC0gZGF0ZXRzKSAvIDEwMDA7XHJcbiAgICAgICAgICAgIGlmICh0aW1lc3RhbXAgPCA2MCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwi5Yia5YiaXCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGltZXN0YW1wID49IDYwICYmIHRpbWVzdGFtcCA8IDYwICogNjApIHtcclxuICAgICAgICAgICAgICAgIG1pbnV0ZXMgPSBwYXJzZUludCh0aW1lc3RhbXAgLyA2MCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWludXRlcyArIFwi5YiG6ZKf5YmNXCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGltZXN0YW1wID49IDYwICogNjAgJiYgdGltZXN0YW1wIDwgNjAgKiA2MCAqIDI0KSB7XHJcbiAgICAgICAgICAgICAgICBob3VycyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwIC8gNjApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGhvdXJzICsgXCLlsI/ml7bliY1cIjtcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aW1lc3RhbXAgPj0gNjAgKiA2MCAqIDI0ICYmIHRpbWVzdGFtcCA8IDYwICogNjAgKiAyNCAqIDMwKSB7XHJcbiAgICAgICAgICAgICAgICBkYXlzID0gcGFyc2VJbnQodGltZXN0YW1wIC8gNjAgLyA2MCAvIDI0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXlzICsgXCLlpKnliY1cIjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG1vbnRoID0gZGF0ZS5nZXRNb250aCgpICsgMTtcclxuICAgICAgICAgICAgICAgIHZhciBkYXkgPSBkYXRlLmdldERheSgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGhvdXIgPSBkYXRlLmdldEhvdXJzKCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgbWludXRlID0gZGF0ZS5nZXRNaW51dGVzKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geWVhciArIFwiL1wiICsgbW9udGggKyBcIi9cIiArIGRheSArIFwiIFwiICsgaG91ciArIFwiOlwiICsgbWludXRlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSk7XHJcbiJdfQ==
